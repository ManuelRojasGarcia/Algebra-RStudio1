R version 4.2.3 (2023-03-15 ucrt) -- "Shortstop Beagle"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Workspace loaded from ~/.RData]

> library(reader)
Loading required package: NCmisc

Attaching package: ‘reader’

The following objects are masked from ‘package:NCmisc’:
  
  cat.path, get.ext, rmv.ext

> var_df <- read.csv('C:/Users/Manuel/Desktop/UOC/SEMESTRE 2/Algebra lineal/PRACTICA1/variables.csv')
> df
> head(var_df, 10)
> x <- as.matrix(var_df[, -1])
> head(x, 10)
rent inc_sal inc_ret inc_emp inc_non inc_oth gini dist8020 mean_age perc_chil per_ret home_size
[1,] 20066   11510    2362     898     590    4707 39.7      3.4     39.5      13.8    11.6      2.17
[2,] 18811    9521    4529     502     550    3709 35.6      3.7     43.0      20.2    23.3      2.80
[3,] 20724   13116    3631     640     574    2763 31.8      2.6     41.5      17.3    17.7      2.36
[4,] 15213    9483    2663     721     595    1753 32.5      3.0     40.5      17.6    15.7      2.35
[5,]  4821    1916    1201     343    1259      44 34.2      2.8     30.7      34.1     6.4      3.46
[6,]  9553    4981    2487     613     883     589 28.5      2.8     40.0      23.4    18.5      2.79
[7,] 30340   15996    4993     574     636    8141 33.3      2.7     44.2      18.7    23.2      2.41
[8,] 25658   15572    3997     656     796    4636 35.1      3.2     41.8      17.4    17.0      2.30
[9,] 25572   12486    5688     562     658    6177 33.4      2.7     44.6      17.4    24.4      2.40
[10,] 24310   12519    5053     613     618    5508 33.7      3.1     44.7      15.9    24.2      2.35
> class (x)
[1] "matrix" "array" 
> filas <- nrow(x)
> filas
[1] 61
> writeLines(paste("El número de censales que tiene la ciudad es de:", filas))
El número de censales que tiene la ciudad es de: 61
> mean_age <- x[, "gini"]
> maximo <- max(mean_age)
> minimo <- min(mean_age)
> maximo
[1] 39.7
> minimo
[1] 24.1
> relacion <- maximo / minimo
> redondeado <- round(relacion, 2)
> 
  > writeLines(paste("La relación entre el máximo y el mínimo es", redondeado))
La relación entre el máximo y el mínimo es 1.65
> library(scales)
> Xs <- scale(x, center = TRUE, scale = TRUE) 
> Xs
rent     inc_sal      inc_ret      inc_emp      inc_non     inc_oth        gini   dist8020
[1,]  0.11215097 -0.00395886 -0.931139719  2.418143014 -0.214973914  0.79806710  2.39053026  1.7676480
[2,] -0.08473303 -0.55542215  0.645412259 -1.550917436 -0.530200087  0.35484048  1.21938116  2.5907512
[3,]  0.21537779  0.44131517 -0.007907388 -0.167760007 -0.341064383 -0.06529216  0.13392589 -0.4272940
[4,] -0.64918611 -0.56595790 -0.712153958  0.644093267 -0.175570643 -0.51384816  0.33387817  0.6701770
[5,] -2.27947972 -2.66395824 -1.775799086 -3.144555344  5.057183822 -1.27284043  0.81947658  0.1214415
[6,] -1.53712508 -1.81416690 -0.840198788 -0.438377765  2.094057800 -1.03079784 -0.80870632  0.1214415
[7,]  1.72393277  1.23981404  0.982984995 -0.829270082  0.147536184  2.32315748  0.56239507 -0.1529263
[8,]  0.98942212  1.12225726  0.258367657 -0.007393928  1.408440874  0.76653494  1.07655810  1.2189125
[9,]  0.97593047  0.26664354  1.488616571 -0.949544641  0.320910579  1.45091592  0.59095969 -0.1529263
[10,]  0.77794832  0.27579300  1.026636642 -0.438377765  0.005684406  1.15380309  0.67665352  0.9445447
[11,]  1.07350963  0.91514662  1.108119716 -0.137691367  1.219305171  0.83404040 -0.38023714 -0.1529263
[12,]  0.42010577 -0.03584336  1.236892074 -0.929498881 -0.916352148  0.58533609  0.76234736  0.9445447
[13,]  1.02989708  0.93538635  0.627951601 -0.668904003  0.336671888  1.04543907  1.19081654  0.6701770
[14,]  0.96008562  0.54279107  0.863670494 -0.157737127 -0.081002791  1.33322549  0.44813662 -0.4272940
[15,]  0.07449984  0.22505505  0.297654139  0.503772948 -0.017957557 -0.35219035 -0.58018942 -0.4272940
[16,]  0.08077503  0.66034784 -0.311286334  0.203086551 -0.742977753 -0.60577993 -1.18004628 -1.2503973
[17,] -0.34154506  0.25971212 -0.987159333  1.065054224 -0.798142334 -0.78164941 -0.26597869 -0.1529263
[18,]  0.75849524  0.22893665  2.109197484 -1.079842080  0.234223381  0.52848939  0.21961972  0.3958092
[19,]  0.47234671 -0.26374825  1.600655798  0.082811992 -0.735097099  0.82071696  1.61928573  1.7676480
[20,] -0.66801167 -0.64636230 -0.689600607  0.814482226  0.975004887 -0.52495103  0.01966744  0.3958092
[21,]  1.48108303  1.83868820  0.624313963 -0.508537924 -0.845426260  0.93707505 -0.29454330 -0.9760295
[22,]  2.39835851  1.78351415  3.336536288 -2.823823186 -1.389191407  2.09976771 -0.23741407 -0.4272940
[23,]  0.80587290  1.06625144  0.140508211  0.323361110 -0.979397383  0.52893350  0.21961972 -0.4272940
[24,]  0.51250790  1.15469628 -0.245081336  0.453658549 -1.302504210 -0.19541781 -1.40856318 -1.2503973
[25,]  0.48630900  1.29748341 -0.899856039 -0.087576967 -0.806022988 -0.10259781 -1.15148167 -1.2503973
[26,]  1.91579662  1.43666620  0.721075114 -1.089864960 -0.199212606  2.74151367  2.13344875  0.9445447
[27,]  0.17192212  0.37837793  0.312932216 -0.418332005  0.060848987 -0.29445542 -0.12315562 -0.1529263
[28,] -0.55223447  0.21562833 -1.842004084  0.283269590  0.202700764 -0.80829630 -0.49449558 -0.7016618
[29,]  0.54482512  0.06507802  0.556653911  0.764367826 -0.356825692  1.08452117  1.59072112  2.0420157
[30,]  1.13830094  0.53807770  1.193967955  0.744322066 -0.151928680  1.60768846  0.73378275  0.1214415
[31,]  0.43234239  0.54694991 -0.301828477  0.032697592  0.573091517  0.49828958  0.59095969  1.2189125
[32,]  0.97091032  1.18269919  0.276555843 -1.180070879 -0.262257840  0.75321150 -1.09435244 -0.9760295
[33,]  1.17077503  1.35487551  0.842572198 -1.370505597 -0.301661112  0.70746767 -1.03722322 -0.9760295
[34,] -0.13666020 -0.21716915  0.804013243 -1.069819200  0.975004887 -0.53738624  0.24818434  0.6701770
[35,] -1.11794258 -1.11575764 -0.549915337 -0.318103205 -0.703574482 -0.98771870  0.50526585  0.3958092
[36,] -0.92388242 -0.61253700 -1.046089056  0.714253427 -0.790261679 -0.98283344 -0.26597869 -0.1529263
[37,] -1.56191207 -1.66112129 -0.952238015 -0.298057446 -0.388348309 -1.14360301 -0.23741407 -0.1529263
[38,] -0.88152491 -0.67491972 -0.873665051  0.443635669  0.281507307 -0.91666032 -0.06602640 -0.1529263
[39,] -1.24940775 -1.21667903 -0.938414994  0.583955988 -0.632648593 -1.00503918  0.13392589 -0.4272940
[40,] -1.22603268 -1.24135486 -0.757260659  0.654116147 -0.735097099 -1.00725975  0.04823205  0.6701770
[41,] -1.39640401 -1.60650174 -0.493895723 -0.237920166  0.510046282 -1.09563861 -0.69444787 -0.1529263
[42,] -1.43264322 -1.35807987 -1.216330479 -0.318103205 -0.813903642 -1.07742990  0.30531356  0.6701770
[43,] -0.88199555 -1.10854897  0.248909800  0.062766232 -0.530200087 -0.84515783  0.24818434  0.6701770
[44,] -0.63553758 -0.77750465  0.445342211  0.343406870 -0.538080741 -0.81007276  0.01966744 -0.1529263
[45,] -0.85548288 -0.53213260 -1.071552517  0.363452629 -0.396228964 -0.90822214 -0.66588326 -0.4272940
[46,] -1.06868237 -0.70735874 -1.433133658  1.024962704 -0.813903642 -1.01658616 -0.43736636  0.3958092
[47,]  0.54968839  1.04407092 -0.269817270  0.082811992  0.100252258  0.03951894 -0.60875403 -0.9760295
[48,]  0.51078223  0.73160278  0.758906541  0.183040791  0.431239739 -0.22162059 -0.20884946 -0.1529263
[49,]  0.06508706  0.12718349 -1.156673228  2.809035331 -1.397072061  0.64129456  1.61928573  1.7676480
[50,] -0.20427534 -0.17114456 -0.733979781  1.085099984  0.210581419  0.08393043  2.27627181  1.7676480
[51,]  1.84535764  1.39369143  1.801453373 -1.671191995 -0.167689989  1.97585967  0.16249050 -0.7016618
[52,] -0.80355571 -0.68157388 -0.591384401  0.754344946  0.368194505 -0.87624587  0.07679666  0.1214415
[53,] -0.90348806 -0.89312063 -0.660499509  0.944779665 -0.033718865 -0.76388482 -0.95152938 -0.1529263
[54,] -0.01554909 -0.11513874  0.218353648  0.233155190 -0.427751581  0.02086612 -0.86583555 -1.2503973
[55,] -1.15276987 -1.41713552 -0.552097919  0.624047507  1.471486109 -0.76610539  0.67665352  0.9445447
[56,]  0.69448833  1.53925112 -0.539002425  0.994894065 -0.932113457 -0.16122097 -1.69420930 -1.7991328
[57,] -0.23769071  0.07200944  0.013190907 -0.237920166  0.313029925 -0.80296692 -1.83703237 -1.7991328
[58,] -0.59945525 -0.29591001 -0.798729724  0.934756785  0.935601615 -0.82872558 -1.69420930 -1.5247650
[59,] -0.66440344 -0.48832606 -0.406592430  0.373475509 -0.214973914 -0.85492836 -2.06554926 -1.7991328
[60,] -0.40288501 -0.29008762 -0.212342601  0.062766232  0.714943295 -0.58890357 -0.92296477 -0.7016618
[61,] -0.89438904 -1.14847392  0.256185075  0.523818708  1.715786392 -0.96817765 -1.37999857 -1.2503973
mean_age    perc_chil      per_ret   home_size
[1,] -0.5671366 -1.512406683 -1.169959532 -1.54065428
[2,]  0.7141721  0.414628464  1.302649642  0.66528253
[3,]  0.1650398 -0.458559337  0.119178584 -0.87537175
[4,] -0.2010484 -0.368229565 -0.303489651 -0.91038662
[5,] -3.7887128  4.599907925 -2.268896942  2.97626394
[6,] -0.3840925  1.378146038  0.288245878  0.63026766
[7,]  1.1534779 -0.037020399  1.281516230 -0.70029740
[8,]  0.2748662 -0.428449413 -0.028755298 -1.08546097
[9,]  1.2999132 -0.428449413  1.535117171 -0.73531227
[10,]  1.3365220 -0.880098276  1.492850347 -0.91038662
[11,]  0.8606074 -0.488669261  1.239249406 -1.22552045
[12,]  1.0436515 -0.548889110  1.218115995 -0.80534201
[13,]  0.2748662 -0.247789868  0.182578819 -0.17507435
[14,]  0.7873897 -0.669328806  0.584113643 -0.49020818
[15,]  0.6409544 -1.602736456 -0.176689180 -0.38516357
[16,] -0.2010484 -0.037020399 -0.599357415 -0.73531227
[17,] -1.2993131  0.565178085 -1.317893414 -0.35014870
[18,]  2.1419161 -1.120977669  2.591787758 -0.80534201
[19,]  1.0436515 -0.428449413  1.598517406 -0.98041636
[20,] -0.2376573  0.083419298 -0.303489651  0.21008922
[21,]  0.0552133  0.053309374 -0.134422357  0.59525279
[22,]  1.4463485 -1.030647896  1.196982583  1.40059480
[23,]  0.2016486  0.324298692  0.267112466  1.50563941
[24,] -0.2376573  0.836167403 -0.409156709 -0.17507435
[25,] -1.2993131  1.588915507 -1.423560473  0.17507435
[26,]  0.1650398 -0.247789868  0.161445408  0.80534201
[27,]  0.2382574 -0.006910474  0.267112466 -0.42017844
[28,] -2.8368835  2.311553687 -2.332297178  0.07002974
[29,]  0.2382574 -0.910208200  0.309379290 -1.36557993
[30,]  0.9704338 -1.482296759  0.816581172 -1.61068401
[31,] -0.2742661 -0.609108958 -0.514823768 -0.87537175
[32,]  0.3846927 -0.338119640 -0.007621886 -0.35014870
[33,]  0.0552133  0.294188767 -0.218956004 -0.28011896
[34,]  0.6409544  0.053309374  0.816581172  0.03501487
[35,] -0.1644396 -0.247789868 -0.049888710  0.28011896
[36,] -0.7501807 -0.187570019 -0.937492003  0.42017844
[37,] -0.8233984  0.986717024 -0.240089415  1.82077323
[38,] -0.9332248  0.474848312 -0.789558121  1.19050558
[39,] -1.0796601  0.866277327 -0.641624238  1.22552045
[40,] -0.7867896  0.595288009 -0.578224003  1.75074349
[41,] -0.3108749  0.595288009  0.309379290  1.50563941
[42,] -1.4457483  0.806057478 -1.085425885  1.96083271
[43,]  0.3480839 -0.488669261  0.816581172 -0.14005948
[44,]  0.6409544 -0.639218882  0.710914113  0.35014870
[45,] -0.4939190  0.233968919 -1.022025650  0.28011896
[46,] -1.4457483  0.986717024 -1.508094120  0.77032714
[47,] -0.5671366  0.113529222 -0.916358591 -0.42017844
[48,]  0.4579103 -0.849988351  0.288245878 -0.17507435
[49,] -0.6403543 -1.452186835 -1.423560473 -1.78575836
[50,] -0.1278308 -0.458559337 -0.620490827 -1.22552045
[51,]  1.1534779 -0.368229565  1.154715760  0.84035688
[52,]  0.3114750 -0.669328806  0.098045173 -1.01543123
[53,] -0.4207014  0.384518540 -0.493690356  0.07002974
[54,]  0.6043456  0.565178085  0.626380466 -0.14005948
[55,]  0.1284309  0.655507858  0.499579996  0.84035688
[56,] -0.4573102  0.504958237 -1.212226355  0.42017844
[57,]  0.3480839 -0.067130323 -0.282356239  0.28011896
[58,] -0.4573102  0.956607099 -0.345756474  0.31513383
[59,]  0.1284309 -0.127350171 -0.240089415  0.49020818
[60,]  0.2016486  0.053309374 -0.197822592  0.49020818
[61,]  1.7758279 -1.843615849  2.021185641 -1.68071375
attr(,"scaled:center")
rent      inc_sal      inc_ret      inc_emp      inc_non      inc_oth         gini     dist8020 
19351.114754 11524.278689  3641.868852   656.737705   617.278689  2910.016393    31.331148     2.755738 
mean_age    perc_chil      per_ret    home_size 
41.049180    18.822951    17.136066     2.610000 
attr(,"scaled:scale")
rent      inc_sal      inc_ret      inc_emp      inc_non      inc_oth         gini     dist8020 
6374.3119344 3606.7677549 1374.5185882   99.7717231  126.8930168 2251.6698285    3.5008352    0.3644743 
mean_age    perc_chil      per_ret    home_size 
2.7315821    3.3211641    4.7318436    0.2855930 
> library(fields) 
Loading required package: spam
Spam version 2.9-1 (2022-08-07) is loaded.
Type 'help( Spam)' or 'demo( spam)' for a short introduction 
and overview of this package.
Help for individual functions is also obtained by adding the
suffix '.spam' to the function name, e.g. 'help( chol.spam)'.

Attaching package: ‘spam’

The following objects are masked from ‘package:base’:
  
  backsolve, forwardsolve

Loading required package: viridis
Loading required package: viridisLite

Attaching package: ‘viridis’

The following object is masked from ‘package:scales’:
  
  viridis_pal


Try help(fields) to get started.
> CXs <- cov(Xs)
> 
  > CXs
rent     inc_sal     inc_ret     inc_emp     inc_non    inc_oth        gini    dist8020
rent       1.00000000  0.92673026  0.76122489 -0.28365656 -0.31599008  0.9130952  0.18017222 -0.04145366
inc_sal    0.92673026  1.00000000  0.52982883 -0.13254741 -0.39950272  0.7277385 -0.03060094 -0.23533662
inc_ret    0.76122489  0.52982883  1.00000000 -0.51158121 -0.16092694  0.7283159  0.16273694  0.05805812
inc_emp   -0.28365656 -0.13254741 -0.51158121  1.00000000 -0.29219282 -0.3048800  0.01873346  0.09633633
inc_non   -0.31599008 -0.39950272 -0.16092694 -0.29219282  1.00000000 -0.2019849  0.02066379  0.02290216
inc_oth    0.91309520  0.72773849  0.72831587 -0.30487998 -0.20198487  1.0000000  0.45736948  0.21856466
gini       0.18017222 -0.03060094  0.16273694  0.01873346  0.02066379  0.4573695  1.00000000  0.87938833
dist8020  -0.04145366 -0.23533662  0.05805812  0.09633633  0.02290216  0.2185647  0.87938833  1.00000000
mean_age   0.57540695  0.37060666  0.84615522 -0.16870717 -0.19666356  0.5389530  0.07983447  0.05947531
perc_chil -0.47169903 -0.35485651 -0.55011339 -0.27748580  0.37766463 -0.4420784 -0.24329266 -0.22040906
per_ret    0.41627073  0.14320960  0.83398303 -0.35580857 -0.00395581  0.4569156  0.14512320  0.14831518
home_size -0.39501073 -0.36463033 -0.27233745 -0.39697106  0.12947569 -0.3588892 -0.22597540 -0.21135293
mean_age  perc_chil     per_ret  home_size
rent       0.57540695 -0.4716990  0.41627073 -0.3950107
inc_sal    0.37060666 -0.3548565  0.14320960 -0.3646303
inc_ret    0.84615522 -0.5501134  0.83398303 -0.2723374
inc_emp   -0.16870717 -0.2774858 -0.35580857 -0.3969711
inc_non   -0.19666356  0.3776646 -0.00395581  0.1294757
inc_oth    0.53895303 -0.4420784  0.45691555 -0.3588892
gini       0.07983447 -0.2432927  0.14512320 -0.2259754
dist8020   0.05947531 -0.2204091  0.14831518 -0.2113529
mean_age   1.00000000 -0.7753111  0.91512413 -0.4825750
perc_chil -0.77531110  1.0000000 -0.55090986  0.6871720
per_ret    0.91512413 -0.5509099  1.00000000 -0.3038743
home_size -0.48257496  0.6871720 -0.30387429  1.0000000
> image(CXs[,nrow(CXs):1])
> image.plot(CXs[,nrow(CXs):1],legend.only = FALSE)
> 
  > Absmax = abs(CXs-diag(diag(CXs)))
> Absoluto <- abs(CXs)
> MaxAbsol <- max(abs(Absoluto))
> writeLines(paste("El valor máximo es de ", MaxAbsol))
El valor máximo es de  1
> MinAbsol <- min(Absoluto)
> writeLines(paste("El valor mínimo es", MinAbsol))
El valor mínimo es 0.00395581045248607
> 
  > 
  > 
  > MaximosAbsoluto <- which(Absmax  == max(Absmax ), arr.ind = TRUE, useNames = TRUE)
> MaximosAbsoluto
row col
inc_sal   2   1
rent      1   2
> Maxinombres <- colnames(Absoluto)[MaximosAbsoluto[,2]]
> Maxinombres
[1] "rent"    "inc_sal"
> MinimoAbsoluto <- which(Absoluto == min(Absoluto), arr.ind = TRUE, useNames = TRUE)
> MinimoAbsoluto
row col
per_ret  11   5
inc_non   5  11
> Minimonombres <- colnames(Absoluto)[MinimoAbsoluto[,2]]
> Minimonombres
[1] "inc_non" "per_ret"
>                                     
  > 
  > A.svd <- svd(CXs)
> writeLines(paste("La descomposición en componentes principales (SVD) de la matriz de
+ covarianzas es ", A.svd))
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(5.2184833480441, 2.12534058200506, 1.83652075178474, 1.42519142406365, 0.789519644046039, 0.214553208121732, 0.164761251429022, 0.101520408293856, 0.0585523463312314, 0.0512708430710381, 0.0142859907373198, 2.02072213356864e-07)
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(-0.383121333597568, -0.301861808509468, -0.39322498672812, 0.0958926034088017, 0.137298498415524, -0.373614450823976, -0.134875280448574, -0.0755168790570723, -0.377973553141663, 0.32816461666787, -0.324299375726775, 0.245392190779629, -0.17451951115478, -0.241385093685667, -0.165073992090987, 0.395530693860181, -0.0316568833003461, -0.0220749200380871, 0.503629767131047, 0.56932085749956, -0.0202075943406204, -0.243012775188693, -0.0288886738953687, -0.296690868395744, 0.0840108552107352, 0.280000510853146, 
                  -0.196258955989622, 0.527213413242267, -0.444850211815632, -0.0877994871489636, -0.301655353930872, -0.304050046244814, -0.0365314063000321, -0.228634194395558, -0.265936499205287, -0.291027704943439, -0.315021528853292, -0.378461403776973, 0.103080457903642, 0.10731037267655, 0.144648093276443, -0.36073803975716, -0.335082912312168, -0.169416309853467, 0.397595783910069, -0.276794485739853, 0.432799902693957, -0.146070210683851, 0.117833009457874, 0.162524998285422, -0.118697992808531, 0.0704028757501686, 
                  0.777800206560312, 0.0974701341744418, -0.0498279948045908, -0.152274643797746, -0.0782813989050987, 0.0440833366530094, -0.11632724404601, -0.528117314732427, -0.0824939404553395, 0.0343059612783213, 0.0450599297057586, -0.475686540320974, -0.328893948638794, -0.276411929962115, -0.144943856477957, 0.229006092647373, -0.120869946220852, 0.302519361236142, 0.0254730376222828, -0.6315901273425, 0.0430924596312992, -0.0674182344226034, -0.0623517190938562, 0.438675820264805, -0.0978068048541513, 0.255044139782153, 
                  -0.00537042955683046, -0.0400327357081934, 0.0878186400770634, 0.709766722469097, 0.451285251103635, -0.07674094046349, -0.142913934040105, -0.474114257677702, -0.0867534882653831, -0.208756852861046, -0.192350478219351, 0.425959478122515, 0.294151304445607, -0.556340969677092, -0.139392819633362, -0.107885453612003, -0.0381946886628522, -0.238068845821677, 0.00629431004519748, 0.235797434846185, 0.297983570130513, 0.100204231756715, 0.00655308214974562, -0.548054626050795, 0.602551115498247, -0.393806755133594, 
                  -0.0693345699423898, 0.111197149251893, 0.097600379695527, -0.0163862547706678, 0.0346803850636784, -0.291393733080244, 0.775686025199844, 0.259598730757349, 0.0350463836929594, 0.0752055201621776, -0.207942482881149, 0.0818045759486994, -0.372924932398808, 0.0333635533587006, -0.211481313008116, -0.0554976644326766, -0.0439188424328367, -0.131944091155176, 0.139770924492624, 0.00700911875341706, -0.00853626687216106, -0.000213069479874073, 0.0923890282846508, -0.0223046867700955, 0.71102066766608, 
                  0.286385454739905, -0.602003809704286, -0.0446665728032373, 0.818732046164689, -0.462751079977998, -0.177282497405801, -0.0126061240301686, -0.0166989269243748, -0.289260255913631, -0.0004100789121919, 0.000381258205339545, 0.000156718687099211, -0.000236600078062699, 0.000706977183494065, 0.00018061399375062)
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(-0.383121333597568, -0.301861808509468, -0.39322498672812, 0.0958926034088017, 0.137298498415524, -0.373614450823975, -0.134875280448574, -0.0755168790570724, -0.377973553141663, 0.32816461666787, -0.324299375726775, 0.245392190779629, -0.174519511154779, -0.241385093685667, -0.165073992090987, 0.395530693860182, -0.0316568833003459, -0.0220749200380869, 0.503629767131048, 0.569320857499561, -0.0202075943406203, -0.243012775188694, -0.0288886738953685, -0.296690868395744, 0.0840108552107352, 0.280000510853146, 
                  -0.196258955989622, 0.527213413242267, -0.444850211815632, -0.0877994871489635, -0.301655353930872, -0.304050046244813, -0.0365314063000323, -0.228634194395558, -0.265936499205287, -0.291027704943439, -0.315021528853292, -0.378461403776972, 0.103080457903642, 0.10731037267655, 0.144648093276443, -0.36073803975716, -0.335082912312169, -0.169416309853467, 0.397595783910069, -0.276794485739852, 0.432799902693956, -0.146070210683851, 0.117833009457874, 0.162524998285422, -0.118697992808531, 0.0704028757501692, 
                  0.777800206560313, 0.0974701341744416, -0.0498279948045912, -0.152274643797746, -0.0782813989050987, 0.0440833366530092, -0.11632724404601, -0.528117314732427, -0.0824939404553403, 0.034305961278322, 0.0450599297057588, -0.475686540320974, -0.328893948638794, -0.276411929962115, -0.144943856477957, 0.229006092647373, -0.120869946220851, 0.302519361236142, 0.0254730376222827, -0.6315901273425, 0.0430924596313003, -0.067418234422604, -0.0623517190938564, 0.438675820264805, -0.0978068048541513, 0.255044139782153, 
                  -0.00537042955683041, -0.0400327357081933, 0.0878186400770632, 0.709766722469097, 0.451285251103635, -0.07674094046349, -0.142913934040105, -0.474114257677701, -0.0867534882653838, -0.208756852861047, -0.192350478219351, 0.425959478122515, 0.294151304445607, -0.556340969677093, -0.139392819633362, -0.107885453612003, -0.0381946886628517, -0.238068845821677, 0.00629431004519526, 0.235797434846186, 0.297983570130514, 0.100204231756716, 0.00655308214974595, -0.548054626050794, 0.602551115498247, -0.393806755133594, 
                  -0.0693345699423898, 0.111197149251893, 0.097600379695526, -0.016386254770668, 0.0346803850636782, -0.291393733080245, 0.775686025199844, 0.259598730757349, 0.0350463836929589, 0.0752055201621788, -0.207942482881149, 0.0818045759486993, -0.372924932398806, 0.0333635533587015, -0.211481313008118, -0.0554976644326769, -0.0439188424328436, -0.131944091155172, 0.139770924492622, 0.00700911875341599, -0.00853626687216111, -0.000213069479871195, 0.0923890282846512, -0.0223046867700958, 0.711020667666081, 
                  0.286385454739905, -0.602003809704285, -0.0446665728032372, 0.818732046164689, -0.462751079977998, -0.1772824974058, -0.0126061240301696, -0.0166989269243751, -0.289260255913633, -0.000410078912189554, 0.000381258205338422, 0.00015671868710479, -0.000236600078060728, 0.000706977183489166, 0.000180613993749579)
> 
  > 
  > pca <- prcomp(CXs, scale = TRUE)
> pca$center
rent     inc_sal     inc_ret     inc_emp     inc_non     inc_oth        gini    dist8020    mean_age 
0.27209085  0.18171994  0.28544533 -0.13406340 -0.00170921  0.31109332  0.20367941  0.14787398  0.23019158 
perc_chil     per_ret   home_size 
-0.15177660  0.23703274 -0.09958073 
> pca$scale
rent   inc_sal   inc_ret   inc_emp   inc_non   inc_oth      gini  dist8020  mean_age perc_chil   per_ret 
0.5625456 0.5154974 0.5655764 0.3956210 0.3826377 0.5175665 0.3911565 0.3986062 0.5710852 0.5455824 0.5069376 
home_size 
0.4710212 
> pca$rotation
PC1         PC2         PC3         PC4         PC5          PC6         PC7         PC8
rent      -0.35100167 -0.14230458  0.05220768  0.26391096 -0.18516047 -0.053773095  0.04503350  0.08895514
inc_sal   -0.31638931 -0.19961727  0.22704272  0.35336521 -0.27336381  0.060969553  0.33909535 -0.11127257
inc_ret   -0.35084900 -0.14997244 -0.18897178 -0.06871054  0.11329205 -0.009133726  0.08633491 -0.16095280
inc_emp    0.07368784  0.42410571  0.59154527 -0.24139683 -0.10574433 -0.277235024 -0.22503180  0.18378462
inc_non    0.24800885 -0.04619744 -0.48759531 -0.27977120 -0.70968613 -0.258196053  0.10272342  0.09104178
inc_oth   -0.35478276 -0.03159365 -0.07420498  0.31333013 -0.17501454 -0.236149208 -0.45610198  0.55002124
gini      -0.13077457  0.53762738 -0.29673849  0.33435832 -0.02053500 -0.244202108 -0.27842152 -0.58032129
dist8020  -0.05889222  0.59488956 -0.30351710  0.13347547  0.14579720  0.297217157  0.41741957  0.47766399
mean_age  -0.35191846 -0.05063484 -0.08416606 -0.34678452  0.13346110 -0.086334969  0.01645320  0.05557989
perc_chil  0.34494718 -0.16075214 -0.11629273  0.28087600 -0.04503922  0.518762897 -0.47539465  0.07588050
per_ret   -0.32069017 -0.06497889 -0.27809618 -0.41603555  0.22558106  0.136365350 -0.34448592  0.03880256
home_size  0.30747990 -0.24258694 -0.19675487  0.25336767  0.49018431 -0.592351203  0.09804694  0.18418071
PC9        PC10        PC11          PC12
rent       0.015932286  0.17208138  0.06141675 -0.8387000438
inc_sal   -0.357568776  0.39259627  0.08446641  0.4343975658
inc_ret    0.781145650  0.22294389  0.27289012  0.1825985167
inc_emp    0.108066520  0.40114289  0.24773433  0.0090941632
inc_non   -0.009434785  0.15306603  0.08673100  0.0116398740
inc_oth    0.091603765 -0.26425406 -0.14127504  0.2726167076
gini      -0.117246386  0.01491597  0.07542282  0.0002956350
dist8020   0.001156040  0.12770797  0.06627372 -0.0002733527
mean_age  -0.374658741 -0.32908942  0.68480042 -0.0001312617
perc_chil -0.020922901  0.21190439  0.46315457  0.0002572786
per_ret   -0.273258654  0.51305046 -0.33906117 -0.0006676546
home_size -0.110987771  0.28181777  0.13139304 -0.0001481856
> 
  > library(ggplot2)
> pca$sdev^2
[1] 7.222877e+00 2.322687e+00 1.421236e+00 6.953089e-01 3.123226e-01 1.590081e-02 6.769965e-03 1.852193e-03
[9] 8.252834e-04 2.152906e-04 5.202595e-06 3.375466e-34
> 
  > prop_varianza <- pca$sdev^2 / sum(pca$sdev^2) *100
> 
  > df <- data.frame(prop_varianza, pc = 1:length(prop_varianza))
> 
  > ggplot(data = df, aes(x = pc, y = prop_varianza)) +
  +   geom_col(width = 0.3, fill = "#006400") +
  +   scale_y_continuous(limits = c(0, 100)) +
  +   theme_bw() +
  +   labs(x = "Componente principal", y = "Prop. de varianza explicada")
> 
  > pca <- prcomp(Xs, scale = TRUE)
> prop_varianza <- pca$sdev^2 / sum(pca$sdev^2)
> prop_varianza_acum <- cumsum(prop_varianza)
> L <- which(prop_varianza_acum >= 0.75)[1]
> L
[1] 3
> 
  > pcarent <- pca$rotation[,1]
> pcarent
rent     inc_sal     inc_ret     inc_emp     inc_non     inc_oth        gini    dist8020    mean_age 
-0.38312133 -0.30186181 -0.39322499  0.09589260  0.13729850 -0.37361445 -0.13487528 -0.07551688 -0.37797355 
perc_chil     per_ret   home_size 
0.32816462 -0.32429938  0.24539219 
> Maxpcainc_ret<- max(abs(pcarent))
> Maxpcainc_ret
[1] 0.393225
> column_index <- which.max(abs(pcarent))
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen en mayor",column_name,Maxpcainc_ret))
Variables contribuyen en mayor inc_ret 0.39322498672812
> 
  > Minpcainc_ret<- min(abs(pcarent))
> Minpcainc_ret
[1] 0.07551688
> column_index <- which.min(abs(pcarent))
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen menor",column_name,Minpcainc_ret))
Variables contribuyen menor dist8020 0.0755168790570722
> 
  > 
  > pcarent <- pca$x[,1]
> Maxpcainc_ret<- which(pcarent == max(pcarent))
> Minpcainc_ret<- which(pcarent == min(pcarent))
> 
  > Censal_max <- var_df[, 1][Maxpcainc_ret]
> Censal_min <- var_df[, 1][Minpcainc_ret]
> 
  > Censal_max
[1] 5
> Censal_min
[1] 22
> 
  > 
  > pcaL <- prcomp(Xs, rank = 3)
> pca2 <- pca$x
> 
  > reconstructed <- pcaL$x %*% t(pcaL$rotation[, 1:3])
> error_residual <- Xs - reconstructed
> 
  > sd(x=error_residual)
[1] 0.4810774
> sd
function (x, na.rm = FALSE) 
  sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), 
           na.rm = na.rm))
<bytecode: 0x000001fef4f87808>
  <environment: namespace:stats>
  > 
  > 
  > library(reader)
> pcarent <- pca$rotation[,1]
> pcarent
rent     inc_sal     inc_ret     inc_emp     inc_non     inc_oth        gini    dist8020    mean_age 
-0.38312133 -0.30186181 -0.39322499  0.09589260  0.13729850 -0.37361445 -0.13487528 -0.07551688 -0.37797355 
perc_chil     per_ret   home_size 
0.32816462 -0.32429938  0.24539219 
> Maxpcainc_ret<- max(abs(pcarent))
> column_index <- which.max(abs(pcarent))
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen en mayor",column_name,Maxpcainc_ret))
Variables contribuyen en mayor inc_ret 0.39322498672812
> 
  > Minpcainc_ret<- min(abs(pcarent))
> 
  > column_index <- which.min(abs(pcarent))
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen menor",column_name,Minpcainc_ret))
Variables contribuyen menor dist8020 0.0755168790570722
> 
  > 
  > pcaL <- prcomp(Xs, rank = 3)
> pca2 <- pca$x
> 
  > reconstructed <- pcaL$x %*% t(pcaL$rotation[, 1:3])
> error_residual <- Xs - reconstructed
> 
  > sd(x=error_residual)
[1] 0.4810774
> sd
function (x, na.rm = FALSE) 
  sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), 
           na.rm = na.rm))
<bytecode: 0x000001fef4f87808>
  <environment: namespace:stats>
  > 
  > 
  > library(reader)
> var_df <- read.csv('C:/Users/Manuel/Desktop/UOC/SEMESTRE 2/Algebra lineal/PRACTICA1/variables.csv')
> df
> head(var_df, 10)
> x <- as.matrix(var_df[, -1])
> head(x, 10)
rent inc_sal inc_ret inc_emp inc_non inc_oth gini dist8020 mean_age perc_chil per_ret home_size
[1,] 20066   11510    2362     898     590    4707 39.7      3.4     39.5      13.8    11.6      2.17
[2,] 18811    9521    4529     502     550    3709 35.6      3.7     43.0      20.2    23.3      2.80
[3,] 20724   13116    3631     640     574    2763 31.8      2.6     41.5      17.3    17.7      2.36
[4,] 15213    9483    2663     721     595    1753 32.5      3.0     40.5      17.6    15.7      2.35
[5,]  4821    1916    1201     343    1259      44 34.2      2.8     30.7      34.1     6.4      3.46
[6,]  9553    4981    2487     613     883     589 28.5      2.8     40.0      23.4    18.5      2.79
[7,] 30340   15996    4993     574     636    8141 33.3      2.7     44.2      18.7    23.2      2.41
[8,] 25658   15572    3997     656     796    4636 35.1      3.2     41.8      17.4    17.0      2.30
[9,] 25572   12486    5688     562     658    6177 33.4      2.7     44.6      17.4    24.4      2.40
[10,] 24310   12519    5053     613     618    5508 33.7      3.1     44.7      15.9    24.2      2.35
> class (x)
[1] "matrix" "array" 
> filas <- nrow(x)
> filas
[1] 61
> writeLines(paste("El número de censales que tiene la ciudad es de:", filas))
El número de censales que tiene la ciudad es de: 61
> 
  > mean_age <- x[, "mean_age"]
> maximo <- max(mean_age)
> minimo <- min(mean_age)
> maximo
[1] 46.9
> minimo
[1] 30.7
> relacion <- maximo / minimo
> redondeado <- round(relacion, 2)
> 
  > writeLines(paste("La relación entre el máximo y el mínimo es", redondeado))
La relación entre el máximo y el mínimo es 1.53
> library(scales)
> Xs <- scale(x, center = TRUE, scale = TRUE) 
> Xs
rent     inc_sal      inc_ret      inc_emp      inc_non     inc_oth        gini   dist8020
[1,]  0.11215097 -0.00395886 -0.931139719  2.418143014 -0.214973914  0.79806710  2.39053026  1.7676480
[2,] -0.08473303 -0.55542215  0.645412259 -1.550917436 -0.530200087  0.35484048  1.21938116  2.5907512
[3,]  0.21537779  0.44131517 -0.007907388 -0.167760007 -0.341064383 -0.06529216  0.13392589 -0.4272940
[4,] -0.64918611 -0.56595790 -0.712153958  0.644093267 -0.175570643 -0.51384816  0.33387817  0.6701770
[5,] -2.27947972 -2.66395824 -1.775799086 -3.144555344  5.057183822 -1.27284043  0.81947658  0.1214415
[6,] -1.53712508 -1.81416690 -0.840198788 -0.438377765  2.094057800 -1.03079784 -0.80870632  0.1214415
[7,]  1.72393277  1.23981404  0.982984995 -0.829270082  0.147536184  2.32315748  0.56239507 -0.1529263
[8,]  0.98942212  1.12225726  0.258367657 -0.007393928  1.408440874  0.76653494  1.07655810  1.2189125
[9,]  0.97593047  0.26664354  1.488616571 -0.949544641  0.320910579  1.45091592  0.59095969 -0.1529263
[10,]  0.77794832  0.27579300  1.026636642 -0.438377765  0.005684406  1.15380309  0.67665352  0.9445447
[11,]  1.07350963  0.91514662  1.108119716 -0.137691367  1.219305171  0.83404040 -0.38023714 -0.1529263
[12,]  0.42010577 -0.03584336  1.236892074 -0.929498881 -0.916352148  0.58533609  0.76234736  0.9445447
[13,]  1.02989708  0.93538635  0.627951601 -0.668904003  0.336671888  1.04543907  1.19081654  0.6701770
[14,]  0.96008562  0.54279107  0.863670494 -0.157737127 -0.081002791  1.33322549  0.44813662 -0.4272940
[15,]  0.07449984  0.22505505  0.297654139  0.503772948 -0.017957557 -0.35219035 -0.58018942 -0.4272940
[16,]  0.08077503  0.66034784 -0.311286334  0.203086551 -0.742977753 -0.60577993 -1.18004628 -1.2503973
[17,] -0.34154506  0.25971212 -0.987159333  1.065054224 -0.798142334 -0.78164941 -0.26597869 -0.1529263
[18,]  0.75849524  0.22893665  2.109197484 -1.079842080  0.234223381  0.52848939  0.21961972  0.3958092
[19,]  0.47234671 -0.26374825  1.600655798  0.082811992 -0.735097099  0.82071696  1.61928573  1.7676480
[20,] -0.66801167 -0.64636230 -0.689600607  0.814482226  0.975004887 -0.52495103  0.01966744  0.3958092
[21,]  1.48108303  1.83868820  0.624313963 -0.508537924 -0.845426260  0.93707505 -0.29454330 -0.9760295
[22,]  2.39835851  1.78351415  3.336536288 -2.823823186 -1.389191407  2.09976771 -0.23741407 -0.4272940
[23,]  0.80587290  1.06625144  0.140508211  0.323361110 -0.979397383  0.52893350  0.21961972 -0.4272940
[24,]  0.51250790  1.15469628 -0.245081336  0.453658549 -1.302504210 -0.19541781 -1.40856318 -1.2503973
[25,]  0.48630900  1.29748341 -0.899856039 -0.087576967 -0.806022988 -0.10259781 -1.15148167 -1.2503973
[26,]  1.91579662  1.43666620  0.721075114 -1.089864960 -0.199212606  2.74151367  2.13344875  0.9445447
[27,]  0.17192212  0.37837793  0.312932216 -0.418332005  0.060848987 -0.29445542 -0.12315562 -0.1529263
[28,] -0.55223447  0.21562833 -1.842004084  0.283269590  0.202700764 -0.80829630 -0.49449558 -0.7016618
[29,]  0.54482512  0.06507802  0.556653911  0.764367826 -0.356825692  1.08452117  1.59072112  2.0420157
[30,]  1.13830094  0.53807770  1.193967955  0.744322066 -0.151928680  1.60768846  0.73378275  0.1214415
[31,]  0.43234239  0.54694991 -0.301828477  0.032697592  0.573091517  0.49828958  0.59095969  1.2189125
[32,]  0.97091032  1.18269919  0.276555843 -1.180070879 -0.262257840  0.75321150 -1.09435244 -0.9760295
[33,]  1.17077503  1.35487551  0.842572198 -1.370505597 -0.301661112  0.70746767 -1.03722322 -0.9760295
[34,] -0.13666020 -0.21716915  0.804013243 -1.069819200  0.975004887 -0.53738624  0.24818434  0.6701770
[35,] -1.11794258 -1.11575764 -0.549915337 -0.318103205 -0.703574482 -0.98771870  0.50526585  0.3958092
[36,] -0.92388242 -0.61253700 -1.046089056  0.714253427 -0.790261679 -0.98283344 -0.26597869 -0.1529263
[37,] -1.56191207 -1.66112129 -0.952238015 -0.298057446 -0.388348309 -1.14360301 -0.23741407 -0.1529263
[38,] -0.88152491 -0.67491972 -0.873665051  0.443635669  0.281507307 -0.91666032 -0.06602640 -0.1529263
[39,] -1.24940775 -1.21667903 -0.938414994  0.583955988 -0.632648593 -1.00503918  0.13392589 -0.4272940
[40,] -1.22603268 -1.24135486 -0.757260659  0.654116147 -0.735097099 -1.00725975  0.04823205  0.6701770
[41,] -1.39640401 -1.60650174 -0.493895723 -0.237920166  0.510046282 -1.09563861 -0.69444787 -0.1529263
[42,] -1.43264322 -1.35807987 -1.216330479 -0.318103205 -0.813903642 -1.07742990  0.30531356  0.6701770
[43,] -0.88199555 -1.10854897  0.248909800  0.062766232 -0.530200087 -0.84515783  0.24818434  0.6701770
[44,] -0.63553758 -0.77750465  0.445342211  0.343406870 -0.538080741 -0.81007276  0.01966744 -0.1529263
[45,] -0.85548288 -0.53213260 -1.071552517  0.363452629 -0.396228964 -0.90822214 -0.66588326 -0.4272940
[46,] -1.06868237 -0.70735874 -1.433133658  1.024962704 -0.813903642 -1.01658616 -0.43736636  0.3958092
[47,]  0.54968839  1.04407092 -0.269817270  0.082811992  0.100252258  0.03951894 -0.60875403 -0.9760295
[48,]  0.51078223  0.73160278  0.758906541  0.183040791  0.431239739 -0.22162059 -0.20884946 -0.1529263
[49,]  0.06508706  0.12718349 -1.156673228  2.809035331 -1.397072061  0.64129456  1.61928573  1.7676480
[50,] -0.20427534 -0.17114456 -0.733979781  1.085099984  0.210581419  0.08393043  2.27627181  1.7676480
[51,]  1.84535764  1.39369143  1.801453373 -1.671191995 -0.167689989  1.97585967  0.16249050 -0.7016618
[52,] -0.80355571 -0.68157388 -0.591384401  0.754344946  0.368194505 -0.87624587  0.07679666  0.1214415
[53,] -0.90348806 -0.89312063 -0.660499509  0.944779665 -0.033718865 -0.76388482 -0.95152938 -0.1529263
[54,] -0.01554909 -0.11513874  0.218353648  0.233155190 -0.427751581  0.02086612 -0.86583555 -1.2503973
[55,] -1.15276987 -1.41713552 -0.552097919  0.624047507  1.471486109 -0.76610539  0.67665352  0.9445447
[56,]  0.69448833  1.53925112 -0.539002425  0.994894065 -0.932113457 -0.16122097 -1.69420930 -1.7991328
[57,] -0.23769071  0.07200944  0.013190907 -0.237920166  0.313029925 -0.80296692 -1.83703237 -1.7991328
[58,] -0.59945525 -0.29591001 -0.798729724  0.934756785  0.935601615 -0.82872558 -1.69420930 -1.5247650
[59,] -0.66440344 -0.48832606 -0.406592430  0.373475509 -0.214973914 -0.85492836 -2.06554926 -1.7991328
[60,] -0.40288501 -0.29008762 -0.212342601  0.062766232  0.714943295 -0.58890357 -0.92296477 -0.7016618
[61,] -0.89438904 -1.14847392  0.256185075  0.523818708  1.715786392 -0.96817765 -1.37999857 -1.2503973
mean_age    perc_chil      per_ret   home_size
[1,] -0.5671366 -1.512406683 -1.169959532 -1.54065428
[2,]  0.7141721  0.414628464  1.302649642  0.66528253
[3,]  0.1650398 -0.458559337  0.119178584 -0.87537175
[4,] -0.2010484 -0.368229565 -0.303489651 -0.91038662
[5,] -3.7887128  4.599907925 -2.268896942  2.97626394
[6,] -0.3840925  1.378146038  0.288245878  0.63026766
[7,]  1.1534779 -0.037020399  1.281516230 -0.70029740
[8,]  0.2748662 -0.428449413 -0.028755298 -1.08546097
[9,]  1.2999132 -0.428449413  1.535117171 -0.73531227
[10,]  1.3365220 -0.880098276  1.492850347 -0.91038662
[11,]  0.8606074 -0.488669261  1.239249406 -1.22552045
[12,]  1.0436515 -0.548889110  1.218115995 -0.80534201
[13,]  0.2748662 -0.247789868  0.182578819 -0.17507435
[14,]  0.7873897 -0.669328806  0.584113643 -0.49020818
[15,]  0.6409544 -1.602736456 -0.176689180 -0.38516357
[16,] -0.2010484 -0.037020399 -0.599357415 -0.73531227
[17,] -1.2993131  0.565178085 -1.317893414 -0.35014870
[18,]  2.1419161 -1.120977669  2.591787758 -0.80534201
[19,]  1.0436515 -0.428449413  1.598517406 -0.98041636
[20,] -0.2376573  0.083419298 -0.303489651  0.21008922
[21,]  0.0552133  0.053309374 -0.134422357  0.59525279
[22,]  1.4463485 -1.030647896  1.196982583  1.40059480
[23,]  0.2016486  0.324298692  0.267112466  1.50563941
[24,] -0.2376573  0.836167403 -0.409156709 -0.17507435
[25,] -1.2993131  1.588915507 -1.423560473  0.17507435
[26,]  0.1650398 -0.247789868  0.161445408  0.80534201
[27,]  0.2382574 -0.006910474  0.267112466 -0.42017844
[28,] -2.8368835  2.311553687 -2.332297178  0.07002974
[29,]  0.2382574 -0.910208200  0.309379290 -1.36557993
[30,]  0.9704338 -1.482296759  0.816581172 -1.61068401
[31,] -0.2742661 -0.609108958 -0.514823768 -0.87537175
[32,]  0.3846927 -0.338119640 -0.007621886 -0.35014870
[33,]  0.0552133  0.294188767 -0.218956004 -0.28011896
[34,]  0.6409544  0.053309374  0.816581172  0.03501487
[35,] -0.1644396 -0.247789868 -0.049888710  0.28011896
[36,] -0.7501807 -0.187570019 -0.937492003  0.42017844
[37,] -0.8233984  0.986717024 -0.240089415  1.82077323
[38,] -0.9332248  0.474848312 -0.789558121  1.19050558
[39,] -1.0796601  0.866277327 -0.641624238  1.22552045
[40,] -0.7867896  0.595288009 -0.578224003  1.75074349
[41,] -0.3108749  0.595288009  0.309379290  1.50563941
[42,] -1.4457483  0.806057478 -1.085425885  1.96083271
[43,]  0.3480839 -0.488669261  0.816581172 -0.14005948
[44,]  0.6409544 -0.639218882  0.710914113  0.35014870
[45,] -0.4939190  0.233968919 -1.022025650  0.28011896
[46,] -1.4457483  0.986717024 -1.508094120  0.77032714
[47,] -0.5671366  0.113529222 -0.916358591 -0.42017844
[48,]  0.4579103 -0.849988351  0.288245878 -0.17507435
[49,] -0.6403543 -1.452186835 -1.423560473 -1.78575836
[50,] -0.1278308 -0.458559337 -0.620490827 -1.22552045
[51,]  1.1534779 -0.368229565  1.154715760  0.84035688
[52,]  0.3114750 -0.669328806  0.098045173 -1.01543123
[53,] -0.4207014  0.384518540 -0.493690356  0.07002974
[54,]  0.6043456  0.565178085  0.626380466 -0.14005948
[55,]  0.1284309  0.655507858  0.499579996  0.84035688
[56,] -0.4573102  0.504958237 -1.212226355  0.42017844
[57,]  0.3480839 -0.067130323 -0.282356239  0.28011896
[58,] -0.4573102  0.956607099 -0.345756474  0.31513383
[59,]  0.1284309 -0.127350171 -0.240089415  0.49020818
[60,]  0.2016486  0.053309374 -0.197822592  0.49020818
[61,]  1.7758279 -1.843615849  2.021185641 -1.68071375
attr(,"scaled:center")
rent      inc_sal      inc_ret      inc_emp      inc_non      inc_oth         gini     dist8020 
19351.114754 11524.278689  3641.868852   656.737705   617.278689  2910.016393    31.331148     2.755738 
mean_age    perc_chil      per_ret    home_size 
41.049180    18.822951    17.136066     2.610000 
attr(,"scaled:scale")
rent      inc_sal      inc_ret      inc_emp      inc_non      inc_oth         gini     dist8020 
6374.3119344 3606.7677549 1374.5185882   99.7717231  126.8930168 2251.6698285    3.5008352    0.3644743 
mean_age    perc_chil      per_ret    home_size 
2.7315821    3.3211641    4.7318436    0.2855930 
> library(fields) 
> CXs <- cov(Xs)
> CXs
rent     inc_sal     inc_ret     inc_emp     inc_non    inc_oth        gini    dist8020
rent       1.00000000  0.92673026  0.76122489 -0.28365656 -0.31599008  0.9130952  0.18017222 -0.04145366
inc_sal    0.92673026  1.00000000  0.52982883 -0.13254741 -0.39950272  0.7277385 -0.03060094 -0.23533662
inc_ret    0.76122489  0.52982883  1.00000000 -0.51158121 -0.16092694  0.7283159  0.16273694  0.05805812
inc_emp   -0.28365656 -0.13254741 -0.51158121  1.00000000 -0.29219282 -0.3048800  0.01873346  0.09633633
inc_non   -0.31599008 -0.39950272 -0.16092694 -0.29219282  1.00000000 -0.2019849  0.02066379  0.02290216
inc_oth    0.91309520  0.72773849  0.72831587 -0.30487998 -0.20198487  1.0000000  0.45736948  0.21856466
gini       0.18017222 -0.03060094  0.16273694  0.01873346  0.02066379  0.4573695  1.00000000  0.87938833
dist8020  -0.04145366 -0.23533662  0.05805812  0.09633633  0.02290216  0.2185647  0.87938833  1.00000000
mean_age   0.57540695  0.37060666  0.84615522 -0.16870717 -0.19666356  0.5389530  0.07983447  0.05947531
perc_chil -0.47169903 -0.35485651 -0.55011339 -0.27748580  0.37766463 -0.4420784 -0.24329266 -0.22040906
per_ret    0.41627073  0.14320960  0.83398303 -0.35580857 -0.00395581  0.4569156  0.14512320  0.14831518
home_size -0.39501073 -0.36463033 -0.27233745 -0.39697106  0.12947569 -0.3588892 -0.22597540 -0.21135293
mean_age  perc_chil     per_ret  home_size
rent       0.57540695 -0.4716990  0.41627073 -0.3950107
inc_sal    0.37060666 -0.3548565  0.14320960 -0.3646303
inc_ret    0.84615522 -0.5501134  0.83398303 -0.2723374
inc_emp   -0.16870717 -0.2774858 -0.35580857 -0.3969711
inc_non   -0.19666356  0.3776646 -0.00395581  0.1294757
inc_oth    0.53895303 -0.4420784  0.45691555 -0.3588892
gini       0.07983447 -0.2432927  0.14512320 -0.2259754
dist8020   0.05947531 -0.2204091  0.14831518 -0.2113529
mean_age   1.00000000 -0.7753111  0.91512413 -0.4825750
perc_chil -0.77531110  1.0000000 -0.55090986  0.6871720
per_ret    0.91512413 -0.5509099  1.00000000 -0.3038743
home_size -0.48257496  0.6871720 -0.30387429  1.0000000
> image(CXs[,nrow(CXs):1])
> image.plot(CXs[,nrow(CXs):1],legend.only = FALSE)
> 
  > 
  > Absoluto <- abs(CXs)
> MaxAbsol <- max(abs(Absoluto))
> writeLines(paste("El valor máximo es de ", MaxAbsol))
El valor máximo es de  1
> MinAbsol <- min(abs(Absoluto))
> writeLines(paste("El valor mínimo es de ", MinAbsol))
El valor mínimo es de  0.00395581045248607
> 
  > MaximosAbsoluto <- which(Absoluto == max(Absoluto), arr.ind = TRUE, useNames = TRUE)
> MaximosAbsoluto
row col
rent       1   1
dist8020   8   8
> Maxinombres <- colnames(Absoluto)[MaximosAbsoluto[,2]]
> Maxinombres
[1] "rent"     "dist8020"
> MinimoAbsoluto <- which(Absoluto == min(Absoluto), arr.ind = TRUE, useNames = TRUE)
> MinimoAbsoluto
row col
per_ret  11   5
inc_non   5  11
> Minimonombres <- colnames(Absoluto)[MinimoAbsoluto[,2]]
> Minimonombres
[1] "inc_non" "per_ret"
> writeLines(paste("Las variables con más covarianza es", Maxinombres))
Las variables con más covarianza es rent
Las variables con más covarianza es dist8020
> writeLines(paste("Las variables con menos covarianza es", Minimonombres))
Las variables con menos covarianza es inc_non
Las variables con menos covarianza es per_ret
> 
  > A.svd <- svd(CXs)
> writeLines(paste("La descomposición en componentes principales (SVD) de la matriz de
+ covarianzas es ", A.svd))
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(5.2184833480441, 2.12534058200506, 1.83652075178474, 1.42519142406365, 0.789519644046039, 0.214553208121732, 0.164761251429022, 0.101520408293856, 0.0585523463312314, 0.0512708430710381, 0.0142859907373198, 2.02072213356864e-07)
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(-0.383121333597568, -0.301861808509468, -0.39322498672812, 0.0958926034088017, 0.137298498415524, -0.373614450823976, -0.134875280448574, -0.0755168790570723, -0.377973553141663, 0.32816461666787, -0.324299375726775, 0.245392190779629, -0.17451951115478, -0.241385093685667, -0.165073992090987, 0.395530693860181, -0.0316568833003461, -0.0220749200380871, 0.503629767131047, 0.56932085749956, -0.0202075943406204, -0.243012775188693, -0.0288886738953687, -0.296690868395744, 0.0840108552107352, 0.280000510853146, 
                  -0.196258955989622, 0.527213413242267, -0.444850211815632, -0.0877994871489636, -0.301655353930872, -0.304050046244814, -0.0365314063000321, -0.228634194395558, -0.265936499205287, -0.291027704943439, -0.315021528853292, -0.378461403776973, 0.103080457903642, 0.10731037267655, 0.144648093276443, -0.36073803975716, -0.335082912312168, -0.169416309853467, 0.397595783910069, -0.276794485739853, 0.432799902693957, -0.146070210683851, 0.117833009457874, 0.162524998285422, -0.118697992808531, 0.0704028757501686, 
                  0.777800206560312, 0.0974701341744418, -0.0498279948045908, -0.152274643797746, -0.0782813989050987, 0.0440833366530094, -0.11632724404601, -0.528117314732427, -0.0824939404553395, 0.0343059612783213, 0.0450599297057586, -0.475686540320974, -0.328893948638794, -0.276411929962115, -0.144943856477957, 0.229006092647373, -0.120869946220852, 0.302519361236142, 0.0254730376222828, -0.6315901273425, 0.0430924596312992, -0.0674182344226034, -0.0623517190938562, 0.438675820264805, -0.0978068048541513, 0.255044139782153, 
                  -0.00537042955683046, -0.0400327357081934, 0.0878186400770634, 0.709766722469097, 0.451285251103635, -0.07674094046349, -0.142913934040105, -0.474114257677702, -0.0867534882653831, -0.208756852861046, -0.192350478219351, 0.425959478122515, 0.294151304445607, -0.556340969677092, -0.139392819633362, -0.107885453612003, -0.0381946886628522, -0.238068845821677, 0.00629431004519748, 0.235797434846185, 0.297983570130513, 0.100204231756715, 0.00655308214974562, -0.548054626050795, 0.602551115498247, -0.393806755133594, 
                  -0.0693345699423898, 0.111197149251893, 0.097600379695527, -0.0163862547706678, 0.0346803850636784, -0.291393733080244, 0.775686025199844, 0.259598730757349, 0.0350463836929594, 0.0752055201621776, -0.207942482881149, 0.0818045759486994, -0.372924932398808, 0.0333635533587006, -0.211481313008116, -0.0554976644326766, -0.0439188424328367, -0.131944091155176, 0.139770924492624, 0.00700911875341706, -0.00853626687216106, -0.000213069479874073, 0.0923890282846508, -0.0223046867700955, 0.71102066766608, 
                  0.286385454739905, -0.602003809704286, -0.0446665728032373, 0.818732046164689, -0.462751079977998, -0.177282497405801, -0.0126061240301686, -0.0166989269243748, -0.289260255913631, -0.0004100789121919, 0.000381258205339545, 0.000156718687099211, -0.000236600078062699, 0.000706977183494065, 0.00018061399375062)
La descomposición en componentes principales (SVD) de la matriz de
covarianzas es  c(-0.383121333597568, -0.301861808509468, -0.39322498672812, 0.0958926034088017, 0.137298498415524, -0.373614450823975, -0.134875280448574, -0.0755168790570724, -0.377973553141663, 0.32816461666787, -0.324299375726775, 0.245392190779629, -0.174519511154779, -0.241385093685667, -0.165073992090987, 0.395530693860182, -0.0316568833003459, -0.0220749200380869, 0.503629767131048, 0.569320857499561, -0.0202075943406203, -0.243012775188694, -0.0288886738953685, -0.296690868395744, 0.0840108552107352, 0.280000510853146, 
                  -0.196258955989622, 0.527213413242267, -0.444850211815632, -0.0877994871489635, -0.301655353930872, -0.304050046244813, -0.0365314063000323, -0.228634194395558, -0.265936499205287, -0.291027704943439, -0.315021528853292, -0.378461403776972, 0.103080457903642, 0.10731037267655, 0.144648093276443, -0.36073803975716, -0.335082912312169, -0.169416309853467, 0.397595783910069, -0.276794485739852, 0.432799902693956, -0.146070210683851, 0.117833009457874, 0.162524998285422, -0.118697992808531, 0.0704028757501692, 
                  0.777800206560313, 0.0974701341744416, -0.0498279948045912, -0.152274643797746, -0.0782813989050987, 0.0440833366530092, -0.11632724404601, -0.528117314732427, -0.0824939404553403, 0.034305961278322, 0.0450599297057588, -0.475686540320974, -0.328893948638794, -0.276411929962115, -0.144943856477957, 0.229006092647373, -0.120869946220851, 0.302519361236142, 0.0254730376222827, -0.6315901273425, 0.0430924596313003, -0.067418234422604, -0.0623517190938564, 0.438675820264805, -0.0978068048541513, 0.255044139782153, 
                  -0.00537042955683041, -0.0400327357081933, 0.0878186400770632, 0.709766722469097, 0.451285251103635, -0.07674094046349, -0.142913934040105, -0.474114257677701, -0.0867534882653838, -0.208756852861047, -0.192350478219351, 0.425959478122515, 0.294151304445607, -0.556340969677093, -0.139392819633362, -0.107885453612003, -0.0381946886628517, -0.238068845821677, 0.00629431004519526, 0.235797434846186, 0.297983570130514, 0.100204231756716, 0.00655308214974595, -0.548054626050794, 0.602551115498247, -0.393806755133594, 
                  -0.0693345699423898, 0.111197149251893, 0.097600379695526, -0.016386254770668, 0.0346803850636782, -0.291393733080245, 0.775686025199844, 0.259598730757349, 0.0350463836929589, 0.0752055201621788, -0.207942482881149, 0.0818045759486993, -0.372924932398806, 0.0333635533587015, -0.211481313008118, -0.0554976644326769, -0.0439188424328436, -0.131944091155172, 0.139770924492622, 0.00700911875341599, -0.00853626687216111, -0.000213069479871195, 0.0923890282846512, -0.0223046867700958, 0.711020667666081, 
                  0.286385454739905, -0.602003809704285, -0.0446665728032372, 0.818732046164689, -0.462751079977998, -0.1772824974058, -0.0126061240301696, -0.0166989269243751, -0.289260255913633, -0.000410078912189554, 0.000381258205338422, 0.00015671868710479, -0.000236600078060728, 0.000706977183489166, 0.000180613993749579)
> 
  > 
  > pca <- prcomp(CXs, scale = TRUE)
> pca$center
rent     inc_sal     inc_ret     inc_emp     inc_non     inc_oth        gini    dist8020    mean_age 
0.27209085  0.18171994  0.28544533 -0.13406340 -0.00170921  0.31109332  0.20367941  0.14787398  0.23019158 
perc_chil     per_ret   home_size 
-0.15177660  0.23703274 -0.09958073 
> pca$scale
rent   inc_sal   inc_ret   inc_emp   inc_non   inc_oth      gini  dist8020  mean_age perc_chil   per_ret 
0.5625456 0.5154974 0.5655764 0.3956210 0.3826377 0.5175665 0.3911565 0.3986062 0.5710852 0.5455824 0.5069376 
home_size 
0.4710212 
> pca$rotation
PC1         PC2         PC3         PC4         PC5          PC6         PC7         PC8
rent      -0.35100167 -0.14230458  0.05220768  0.26391096 -0.18516047 -0.053773095  0.04503350  0.08895514
inc_sal   -0.31638931 -0.19961727  0.22704272  0.35336521 -0.27336381  0.060969553  0.33909535 -0.11127257
inc_ret   -0.35084900 -0.14997244 -0.18897178 -0.06871054  0.11329205 -0.009133726  0.08633491 -0.16095280
inc_emp    0.07368784  0.42410571  0.59154527 -0.24139683 -0.10574433 -0.277235024 -0.22503180  0.18378462
inc_non    0.24800885 -0.04619744 -0.48759531 -0.27977120 -0.70968613 -0.258196053  0.10272342  0.09104178
inc_oth   -0.35478276 -0.03159365 -0.07420498  0.31333013 -0.17501454 -0.236149208 -0.45610198  0.55002124
gini      -0.13077457  0.53762738 -0.29673849  0.33435832 -0.02053500 -0.244202108 -0.27842152 -0.58032129
dist8020  -0.05889222  0.59488956 -0.30351710  0.13347547  0.14579720  0.297217157  0.41741957  0.47766399
mean_age  -0.35191846 -0.05063484 -0.08416606 -0.34678452  0.13346110 -0.086334969  0.01645320  0.05557989
perc_chil  0.34494718 -0.16075214 -0.11629273  0.28087600 -0.04503922  0.518762897 -0.47539465  0.07588050
per_ret   -0.32069017 -0.06497889 -0.27809618 -0.41603555  0.22558106  0.136365350 -0.34448592  0.03880256
home_size  0.30747990 -0.24258694 -0.19675487  0.25336767  0.49018431 -0.592351203  0.09804694  0.18418071
PC9        PC10        PC11          PC12
rent       0.015932286  0.17208138  0.06141675 -0.8387000438
inc_sal   -0.357568776  0.39259627  0.08446641  0.4343975658
inc_ret    0.781145650  0.22294389  0.27289012  0.1825985167
inc_emp    0.108066520  0.40114289  0.24773433  0.0090941632
inc_non   -0.009434785  0.15306603  0.08673100  0.0116398740
inc_oth    0.091603765 -0.26425406 -0.14127504  0.2726167076
gini      -0.117246386  0.01491597  0.07542282  0.0002956350
dist8020   0.001156040  0.12770797  0.06627372 -0.0002733527
mean_age  -0.374658741 -0.32908942  0.68480042 -0.0001312617
perc_chil -0.020922901  0.21190439  0.46315457  0.0002572786
per_ret   -0.273258654  0.51305046 -0.33906117 -0.0006676546
home_size -0.110987771  0.28181777  0.13139304 -0.0001481856
> 
  > library(ggplot2)
> pca$sdev^2
[1] 7.222877e+00 2.322687e+00 1.421236e+00 6.953089e-01 3.123226e-01 1.590081e-02 6.769965e-03 1.852193e-03
[9] 8.252834e-04 2.152906e-04 5.202595e-06 3.375466e-34
> 
  > prop_varianza <- pca$sdev^2 / sum(pca$sdev^2) *100
> 
  > df <- data.frame(prop_varianza, pc = 1:length(prop_varianza))
> 
  > ggplot(data = df, aes(x = pc, y = prop_varianza)) +
  +   geom_col(width = 0.3, fill = "#006400") +
  +   scale_y_continuous(limits = c(0, 100)) +
  +   theme_bw() +
  +   labs(x = "Componente principal", y = "Prop. de varianza explicada")
> 
  > pca <- prcomp(Xs, scale = TRUE)
> prop_varianza <- pca$sdev^2 / sum(pca$sdev^2)
> prop_varianza_acum <- cumsum(prop_varianza)
> L <- which(prop_varianza_acum >= 0.75)
> L
[1]  3  4  5  6  7  8  9 10 11 12
> 
  > pcainc_ret <- pca$rotation[,3]
> pcainc_ret
rent     inc_sal     inc_ret     inc_emp     inc_non     inc_oth        gini    dist8020    mean_age 
-0.08401086 -0.28000051  0.19625896 -0.52721341  0.44485021  0.08779949  0.30165535  0.30405005  0.03653141 
perc_chil     per_ret   home_size 
0.22863419  0.26593650  0.29102770 
> Maxpcainc_ret<- max(pcainc_ret)
> Maxpcainc_ret
[1] 0.4448502
> column_index <- which.max(pcainc_ret)
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen en mayor",column_name,Maxpcainc_ret))
Variables contribuyen en mayor inc_non 0.444850211815633
> 
  > Minpcainc_ret<- min(pcainc_ret)
> Minpcainc_ret
[1] -0.5272134
> column_index <- which.min(pcainc_ret)
> column_name <- colnames(Xs)[column_index]
> writeLines(paste("Variables contribuyen menor",column_name,Minpcainc_ret))
Variables contribuyen menor inc_emp -0.527213413242266
> 
  > 
  > pcainc_ret <- pca$x[,3]
> Maxpcainc_ret<- which(pcainc_ret == max(pcainc_ret))
> Minpcainc_ret<- which(pcainc_ret == min(pcainc_ret))
> 
  > Censal_max <- var_df[, 1][Maxpcainc_ret]
> Censal_min <- var_df[, 1][Minpcainc_ret]
> 
  > Censal_max
[1] 5
> Censal_min
[1] 56
> 
  > 
  > 
  > pcaL <- prcomp(Xs, rank = 3)
> pca2 <- pca$x
> 
  > reconstructed <- pcaL$x %*% t(pcaL$rotation[, 1:3])
> error_residual <- Xs - reconstructed
> 
  > sd(x=error_residual)
[1] 0.4810774
> sd
function (x, na.rm = FALSE) 
  sqrt(var(if (is.vector(x) || is.factor(x)) x else as.double(x), 
           na.rm = na.rm))
<bytecode: 0x000001fef4f87808>
  <environment: namespace:stats>
  > 